<!DOCTYPE html>
<html>
<head>
    <title>Patch Report Checking Automation</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="app">
        <div class="top-controls">
            <button class="theme-btn" @click="toggleTheme" :title="theme==='dark' ? 'Switch to light' : 'Switch to dark'">
                <i :class="theme==='dark' ? 'fa fa-sun' : 'fa fa-moon'"></i>
            </button>
        </div>
        <h1>Patch Report Checking Automation</h1>
        <p class="app-subtitle">Please upload your file to start the process.</p>

        <div class="upload-container">
                <upload-box ref="file1" label="Upload Raw Data (Excel)"
                    icon="fa fa-file-excel"
                    accept=".xls,.xlsx,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                    :filename="file1Name" :invalid="invalid1"
                    @file="onSelected('file1', $event)"></upload-box>

                <upload-box ref="file2" label="Upload Patch Report (PowerPoint)"
                    icon="fa fa-file-powerpoint"
                    accept=".ppt,.pptx,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation"
                    :filename="file2Name" :invalid="invalid2"
                    @file="onSelected('file2', $event)"></upload-box>
        </div>

        <div class="actions">
            <button class="btn primary" :disabled="!canSubmit || submitting" @click="submitFiles">
                <i :class="submitting ? 'fa fa-spinner fa-spin' : 'fa fa-paper-plane'"></i>
                <span>{{ submitting ? 'Submitting...' : 'Submit' }}</span>
            </button>
            <button class="btn" v-if="submitting" @click="cancelUpload"><i class="fa fa-times"></i> Cancel</button>
        </div>

        <!-- Progress bar -->
        <div class="progress-wrap" v-if="submitting || progressPercent > 0">
            <div class="progress-bar" role="progressbar" :aria-valuenow="progressPercent" aria-valuemin="0" aria-valuemax="100">
                <div class="progress-fill" :style="{ width: progressPercent + '%' }"></div>
            </div>
            <div class="progress-label">{{ progressPercent }}%</div>
        </div>

        <!-- Toast notifications (inside Vue app) -->
        <div class="toast-container">
            <div v-for="n in notifications" :key="n.id" :class="['toast', n.type]">{{ n.message }}</div>
        </div>
    </div>

    <!-- Vue 3 via CDN -->
    <!-- Vue is imported as ESM in renderer/main.js for a modular frontend -->
    <script type="module" src="renderer/main.js"></script>
</body>
</html>